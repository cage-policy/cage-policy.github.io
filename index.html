<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="CAGE">
  <meta name="keywords" content="CAGE, Robotics, Robot Learning, Imitation Learning, Generalization">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CAGE: Causal Attention Enables Data-Efficient Generalizable Robotic Manipulation</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/cage.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://cage-policy.github.io/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://rh20t.github.io/">
            RH20T
          </a>
          <a class="navbar-item" href="https://airexo.github.io/">
            AirExo
          </a>
          <a class="navbar-item" href="https://rise-policy.github.io/">
            RISE
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>



<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title"><img src="static/images/cage.png" style="width:40px"> <text style="color:rgb(66, 106, 179)">CAGE</text></h1>


          <h2 class="title is-2 publication-title"><text style="color:rgb(66, 106, 179)">C</text>ausal <text style="color:rgb(66, 106, 179)">A</text>ttention Enables Data-Efficient <text style="color:rgb(66, 106, 179)">Ge</text>neralizable Robotic Manipulation </h2>
          
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://github.com/Xiashangning">Shangning Xia</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://tonyfang.net/">Hongjie Fang</a><sup>1,2</sup>,</span>
            <span class="author-block">
              <a href="https://fang-haoshu.github.io/">Hao-Shu Fang</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.mvig.org/">Cewu Lu</a><sup>1,2</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <sup>1</sup><span class="author-block">Shanghai Jiao Tong University</span>, <sup>2</sup><span class="author-block">Shanghai Artificial Intelligence Laboratory</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2410.14974"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/cage-policy/CAGE"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (coming soon)</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=3lg9LntjAKc"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                  </a>
              </span>
              <!-- Data Link. 
              <span class="link-block">
                <a href="https://drive.google.com/drive/folders/1eIjPKf_g-1DjYqMTYjSzVBixjnveyD89?usp=sharing"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Sample Data</span>
                </a>
              </span>  
              -->      
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img id="teaser" src="static/images/teaser.jpg"></img>
      CAGE is a data-efficient generalizable robotic manipulation policy. With <b>less than 50 demonstrations in the mono-distributed training environment</b>, CAGE can effectively <b>generalize to similar and unseen environments</b> with different levels of distribution shifts.
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
Generalization in robotic manipulation remains a critical challenge, particularly when scaling to unseen environments with limited demonstrations. This paper introduces CAGE, a novel robotic manipulation policy designed to overcome these generalization barriers by integrating a causal attention mechanism. CAGE utilizes the powerful feature extraction capabilities of the DINOv2 foundation model, combined with LoRA fine-tuning for efficient image encoding. The policy further employs a causal Perceiver for compressing tokens and a diffusion-based action prediction head with attention mechanisms to enhance task-specific fine-grained conditioning. With as few as 50 demonstrations in a single training environment, CAGE achieves robust generalization across diverse visual changes in objects, backgrounds, camera views, and all three combined. Extensive experiments validate that CAGE significantly outperforms existing state-of-the-art approaches in various manipulation tasks, especially under significant distribution shifts. This work makes a step forward in developing data-efficient, scalable, and generalizable robotic manipulation policies.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method</h2>
          <img id="model" src="static/images/model.png"></img>
          <br><br>
          <div class="content has-text-justified">
            <p>
              CAGE is composed of three parts: (1) observation images are passed to <i>DINOv2 image encoder (LoRA fine-tuning)</i> to obtain stacks of observation tokens. (2) The concatenated observation tokens are compressed by <i>Causal Observation Perceiver</i>. The learned tokens, along with the timestep embeddings serve as the conditioning for noise prediction. (3) The <i>Attn-UNet</i> takes as input a sequence of noisy actions prefixed by proprioceptions and outputs noise estimation, following standard diffusion procedure.
            </p>  
          </div>
        </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Evaluations</h2>
        <img id="model" src="static/images/task.jpg"></img>
        <div class="content has-text-justified">
          <p>
            To evaluate the generalization ability of the policy, we design 3 tasks with <i>generalizable skills</i>: <b><i>Transport</i></b>, <b><i>Dumping</i></b> and <b><i>Chopping</i></b>. With a special focus on generalization, our tasks are designed at the skill level, so we do not impose strict requirements on the objects, and they can be substituted with any similar items.
            We evaluate CAGE and various baselines (2D: <a href="https://diffusion-policy.cs.columbia.edu/">Diffusion Policy (DP)</a>; 3D: <a href="https://rise-policy.github.io/">RISE</a>) on these tasks.
          </p>
          <p>
            Each policy is evaluated through three levels of distribution shifts to fully assess its generalizability in real-world:
            <ul>
              <li><b>Base</b> refers to evaluations in <i>the same environment</i> as the training data (No distribution shift with seen objects, the same background, and the same camera views). </li>
              <li> <b>L1 generalization</b> denotes <i>a similar environment</i> with the variation in one of the previous three aspects, which we refer to as <b>L1 (bg)</b>, <b>L1 (obj)</b> and <b>L1 (cam)</b> respectively. (Small distribution shift)</li>
              <li> <b>L2 generalization</b> allows variations on all three aspects, resulting in <i>an unseen environment</i> for the policy. (Large distribution shift)</li>
            </ul>
          </p>
          <p>
            In the following sections, all the videos are <b>autonomous rollouts</b> of the CAGE policy with <b>10Hz parallel execution</b>.
          </p>
        </div>


        <h2 class="title is-3">Base Evaluation Results</h2>
        <div class="content has-text-justified">
          <p>
            <div class="columns is-centered has-text-centered">
              <img src="static/images/base-results.png"></img>
            </div>
          </p>
        </div>


        <div class="content has-text-justified">
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-base-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/base/transport-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-base-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/base/dumping-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-base-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/base/chopping-1.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-base-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/base/transport-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-base-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/base/dumping-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-base-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/base/chopping-2.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
        </div>
        <br>

        <h2 class="title is-3">L1 Generalization Evaluation Results</h2>
        <div class="content has-text-justified">
          <p>
            <div class="columns is-centered has-text-centered">
              <img src="static/images/l1-results.png"></img>
            </div>
          </p>
        </div>
        
        <h5 class="title is-5">Background - L1 (bg)</h5>
        <div class="content has-text-justified">
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l1bg-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1bg/transport-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1bg-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1bg/dumping-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l1bg-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1bg/chopping-1.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p></p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l1bg-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1bg/transport-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1bg-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1bg/dumping-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l1bg-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1bg/chopping-2.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
        </div>

        <h5 class="title is-5">Object - L1 (obj)</h5>
        <div class="content has-text-justified">
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l1obj-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1obj/transport-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1obj-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1obj/dumping-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l1obj-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1obj/chopping-1.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l1obj-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1obj/transport-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1obj-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1obj/dumping-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l1obj-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1obj/chopping-2.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
        </div>

        <h5 class="title is-5">Camera View - L1 (cam)</h5>
        <div class="content has-text-justified">
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l1cam-wo" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1cam/transport-wo.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1cam-wo" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1cam/dumping-wo.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l1cam-wo" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1cam/chopping-wo.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l1cam-w" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1cam/transport-w.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1cam-w" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1cam/dumping-w.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l1cam-w" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l1cam/chopping-w.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
        </div>
        <br>

        <h2 class="title is-3">L2 Generalization Evaluation Results</h2>
        <div class="content has-text-justified">
          <p>
            <div class="columns is-centered has-text-centered">
              <img src="static/images/l2-results.png"></img>
            </div>
          </p>
        </div>

        <div class="content has-text-justified">
          <p>
            <b>CAGE Rollouts</b>.
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l2-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/transport-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l2-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/dumping-1.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l2-1" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/chopping-1.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l2-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/transport-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l2-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/dumping-2.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l2-2" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/chopping-2.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <b>RISE Rollouts</b>.
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l2-rise" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/transport-rise.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l2-rise" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/dumping-rise.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l2-rise" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/chopping-rise.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <b>Diffusion Policy (DP) Rollouts</b>.
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l2-dp" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/transport-dp.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l2-dp" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/dumping-dp.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="chopping-l2-dp" autoplay muted loop playsinline controls style="width:220px">
                <source src="./static/videos/l2/chopping-dp.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <b>Complete Evaluation Video for <i>Transport</i> in unseen environment</b>.
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l2-full" autoplay muted loop playsinline controls style="width:480px">
                <source src="./static/videos/l2/transport-full.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
        </div>
        <br>

        <h2 class="title is-3">Failure Cases</h2>
        <div class="content has-text-justified">
          <p>
            We also show some failure cases in L1 and L2 evaluations of the CAGE policy here. Most failures are due to inaccuracies in predicted actions, which can be amplified and accumulated by real-time execution with relative action representation.
          </p>
          <br>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="transport-l1bg-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/transport-l1bg.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="transport-l1obj-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/transport-l1obj.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="transport-l1cam-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/transport-l1cam.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="transport-l2-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/transport-l2.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
          <p>
            <div class="columns is-centered has-text-centered">
              <video id="dumping-l1bg-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/dumping-l1bg.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1obj-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/dumping-l1obj.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l1cam-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/dumping-l1cam.mp4"
                        type="video/mp4">
              </video>
              &nbsp;
              <video id="dumping-l2-failure" autoplay muted loop playsinline controls style="width:160px">
                <source src="./static/videos/failure/dumping-l2.mp4"
                        type="video/mp4">
              </video>
            </div>
          </p>
        </div>
        <br>
        
      </div>
    </div>
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <div class="columns is-centered has-text-centered">
    <h2 class="title">BibTeX</h2>
    </div>
    <pre><code>@article{
  xia2024cage,
  title = {CAGE: Causal Attention Enables Data-Efficient Generalizable Robotic Manipulation},
  author = {Xia, Shangning and Fang, Hongjie and Fang, Hao-Shu and Lu, Cewu},
  journal = {arXiv preprint arXiv:2410.14974},
  year = {2024}
}
</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>. Modified upon original <a href="https://nerfies.github.io/"> Nerfies </a> website (<a href="https://github.com/nerfies/nerfies.github.io">source</a>).
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
